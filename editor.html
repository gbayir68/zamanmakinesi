<script>
    const daySelect = document.getElementById('day-select');
    const monthSelect = document.getElementById('month-select');
    const yearSelect = document.getElementById('year-select');
    const fetchBtn = document.getElementById('fetch-btn');
    const dataEditor = document.getElementById('data-editor');
    const status = document.getElementById('status');

    function initSelectors() {
        for (let i = 1; i <= 31; i++) {
            let day = i.toString().padStart(2, '0');
            daySelect.innerHTML += `<option value="${day}">${day}</option>`;
        }
        for (let i = 1995; i <= 2005; i++) {
            yearSelect.innerHTML += `<option value="${i}">${i}</option>`;
        }
        yearSelect.value = "1997";
    }

    function fetchData() {
        const fullDate = `${yearSelect.value}-${monthSelect.value}-${daySelect.value}`;
        
        // ÖNEMLİ: data.js dosyanızdaki ana değişken ismini kontrol edin.
        // Eğer verileriniz 'const veri = { ... }' şeklindeyse buraya 'veri' yazılmalıdır.
        // Aşağıdaki kontrol hem dataJS hem de genel nesne yapısını denetler.
        
        try {
            // Eğer verileriniz global bir nesne içindeyse (Örn: dataJS)
            let source = (typeof dataJS !== 'undefined') ? dataJS : null;
            
            // Eğer değişken ismi farklıysa buraya o ismi ekleyebiliriz
            if (!source && typeof arsivData !== 'undefined') source = arsivData;

            if (source && source[fullDate]) {
                dataEditor.value = source[fullDate];
                showStatus(fullDate + " verisi başarıyla yüklendi.", "#27ae60");
            } else {
                dataEditor.value = "";
                showStatus("Hata: " + fullDate + " tarihinde veri bulunamadı veya değişken ismi hatalı.", "#e67e22");
                console.error("Veri kaynağı bulunamadı veya tarih anahtarı yok:", fullDate);
            }
        } catch (err) {
            showStatus("Sistemsel bir hata oluştu!", "#c0392b");
            console.error(err);
        }
    }

    function showStatus(msg, color) {
        status.textContent = msg;
        status.style.display = "block";
        status.style.color = color;
        setTimeout(() => { status.style.display = "none"; }, 4000);
    }

    initSelectors();
    fetchBtn.addEventListener('click', fetchData);

    window.addEventListener('keypress', (e) => {
        if (e.key === 'Enter') fetchData();
    });
</script>
